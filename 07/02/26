added input validation and error handling
